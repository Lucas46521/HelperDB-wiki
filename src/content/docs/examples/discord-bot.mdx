
---
title: Discord Bot Example
description: How to use Helper.db in a Discord bot
---

import { CodeExample } from '../../../components/CodeExample';

# Using Helper.db in a Discord Bot

This example shows how to integrate Helper.db into a Discord bot for storing user data, guild settings, and more.

## Basic Setup

<CodeExample
  title="Basic Bot Setup"
  code={`const { Client, GatewayIntentBits } = require('discord.js');
const { Database } = require('helper.db');

const client = new Client({
  intents: [GatewayIntentBits.Guilds, GatewayIntentBits.GuildMessages]
});

// Initialize databases
const userDB = new Database('./data/users.json');
const guildDB = new Database('./data/guilds.json');
const economyDB = new Database('./data/economy.json');

client.login('YOUR_BOT_TOKEN');`}
/>

## User Experience System

<CodeExample
  title="Experience System"
  code={`client.on('messageCreate', async (message) => {
  if (message.author.bot) return;
  
  const userId = message.author.id;
  const guildId = message.guild.id;
  
  // Get current XP
  const currentXP = await userDB.get(\`\${guildId}.\${userId}.xp\`, 0);
  const currentLevel = await userDB.get(\`\${guildId}.\${userId}.level\`, 1);
  
  // Add XP (1-5 random)
  const xpGain = Math.floor(Math.random() * 5) + 1;
  const newXP = currentXP + xpGain;
  
  // Calculate level
  const requiredXP = currentLevel * 100;
  let newLevel = currentLevel;
  
  if (newXP >= requiredXP) {
    newLevel++;
    message.reply(\`üéâ Congratulations! You leveled up to level \${newLevel}!\`);
  }
  
  // Save data
  await userDB.set(\`\${guildId}.\${userId}.xp\`, newXP);
  await userDB.set(\`\${guildId}.\${userId}.level\`, newLevel);
  await userDB.set(\`\${guildId}.\${userId}.lastMessage\`, Date.now());
});`}
/>

## Economy System

<CodeExample
  title="Simple Economy Commands"
  code={`// Balance command
client.on('messageCreate', async (message) => {
  if (message.content === '!balance') {
    const userId = message.author.id;
    const balance = await economyDB.get(\`users.\${userId}.coins\`, 0);
    
    message.reply(\`üí∞ You have **\${balance}** coins!\`);
  }
  
  // Daily reward
  if (message.content === '!daily') {
    const userId = message.author.id;
    const lastDaily = await economyDB.get(\`users.\${userId}.lastDaily\`, 0);
    const now = Date.now();
    const oneDay = 24 * 60 * 60 * 1000;
    
    if (now - lastDaily < oneDay) {
      const timeLeft = oneDay - (now - lastDaily);
      const hours = Math.floor(timeLeft / (60 * 60 * 1000));
      const minutes = Math.floor((timeLeft % (60 * 60 * 1000)) / (60 * 1000));
      
      return message.reply(\`‚è∞ You already claimed your daily reward! Try again in \${hours}h \${minutes}m\`);
    }
    
    const reward = Math.floor(Math.random() * 500) + 100;
    const currentBalance = await economyDB.get(\`users.\${userId}.coins\`, 0);
    
    await economyDB.set(\`users.\${userId}.coins\`, currentBalance + reward);
    await economyDB.set(\`users.\${userId}.lastDaily\`, now);
    
    message.reply(\`üéÅ You received **\${reward}** coins! Your balance is now **\${currentBalance + reward}** coins.\`);
  }
});`}
/>

## Guild Settings

<CodeExample
  title="Guild Configuration"
  code={`// Set prefix command
client.on('messageCreate', async (message) => {
  if (!message.content.startsWith('!setprefix')) return;
  if (!message.member.permissions.has('ADMINISTRATOR')) {
    return message.reply('‚ùå You need Administrator permission to use this command!');
  }
  
  const args = message.content.split(' ');
  const newPrefix = args[1];
  
  if (!newPrefix) {
    return message.reply('‚ùå Please provide a new prefix!');
  }
  
  await guildDB.set(\`\${message.guild.id}.prefix\`, newPrefix);
  message.reply(\`‚úÖ Prefix changed to: \${newPrefix}\`);
});

// Get prefix function
async function getPrefix(guildId) {
  return await guildDB.get(\`\${guildId}.prefix\`, '!');
}

// Welcome system
client.on('guildMemberAdd', async (member) => {
  const guildId = member.guild.id;
  const welcomeEnabled = await guildDB.get(\`\${guildId}.welcome.enabled\`, false);
  
  if (!welcomeEnabled) return;
  
  const welcomeChannel = await guildDB.get(\`\${guildId}.welcome.channel\`);
  const welcomeMessage = await guildDB.get(\`\${guildId}.welcome.message\`, 'Welcome {user} to {guild}!');
  
  if (!welcomeChannel) return;
  
  const channel = member.guild.channels.cache.get(welcomeChannel);
  if (!channel) return;
  
  const message = welcomeMessage
    .replace('{user}', member.toString())
    .replace('{guild}', member.guild.name)
    .replace('{memberCount}', member.guild.memberCount);
    
  channel.send(message);
});`}
/>

## Leaderboard System

<CodeExample
  title="XP Leaderboard"
  code={`client.on('messageCreate', async (message) => {
  if (message.content === '!leaderboard' || message.content === '!lb') {
    const guildId = message.guild.id;
    
    // Get all users data for this guild
    const guildData = await userDB.get(guildId, {});
    const users = Object.keys(guildData);
    
    if (users.length === 0) {
      return message.reply('‚ùå No users found in the leaderboard!');
    }
    
    // Sort users by XP
    const sortedUsers = users
      .map(userId => ({
        userId,
        xp: guildData[userId].xp || 0,
        level: guildData[userId].level || 1
      }))
      .sort((a, b) => b.xp - a.xp)
      .slice(0, 10); // Top 10
    
    let leaderboard = 'üèÜ **XP Leaderboard**\\n\\n';
    
    for (let i = 0; i < sortedUsers.length; i++) {
      const user = sortedUsers[i];
      const member = message.guild.members.cache.get(user.userId);
      const displayName = member ? member.displayName : 'Unknown User';
      
      const medal = i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : \`\${i + 1}.\`;
      leaderboard += \`\${medal} **\${displayName}** - Level \${user.level} (\${user.xp} XP)\\n\`;
    }
    
    message.reply(leaderboard);
  }
});`}
/>

## Data Backup and Migration

<CodeExample
  title="Backup System"
  code={`// Backup command (admin only)
client.on('messageCreate', async (message) => {
  if (message.content === '!backup' && message.author.id === 'YOUR_USER_ID') {
    try {
      // Get all data
      const userData = await userDB.all();
      const guildData = await guildDB.all();
      const economyData = await economyDB.all();
      
      const backup = {
        timestamp: new Date().toISOString(),
        users: userData,
        guilds: guildData,
        economy: economyData
      };
      
      // Save backup
      const fs = require('fs');
      const backupPath = \`./backups/backup-\${Date.now()}.json\`;
      
      if (!fs.existsSync('./backups')) {
        fs.mkdirSync('./backups');
      }
      
      fs.writeFileSync(backupPath, JSON.stringify(backup, null, 2));
      
      message.reply(\`‚úÖ Backup created successfully: \${backupPath}\`);
    } catch (error) {
      console.error('Backup failed:', error);
      message.reply('‚ùå Backup failed! Check console for details.');
    }
  }
});

// Auto-backup every 6 hours
setInterval(async () => {
  console.log('Creating automatic backup...');
  // Backup logic here
}, 6 * 60 * 60 * 1000);`}
/>

This example demonstrates how Helper.db can be seamlessly integrated into a Discord bot for various features like experience systems, economy, guild settings, and more. The database operations are simple yet powerful, making it easy to build complex bot functionality.
